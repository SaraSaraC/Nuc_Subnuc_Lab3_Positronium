void NaI1_cal(TString Fname="NaI1_cal.dat"){
  TTree* tree = new TTree("tree","data from ascii file");
  tree->ReadFile(Form("%s",Fname.Data()),"ene/F:cal/F:ecal/F:syscal/F:sig/F:esig/F");
  //                                     V1     V2    V3     V4      V5     V6

  /////  signal vs energy     ////////////////
  
  tree->Draw("cal:ene:ecal+syscal:ene*0.001","","goff");
  TGraphErrors* gra = new TGraphErrors(tree->GetSelectedRows(),tree->GetV1(),tree->GetV2
  (),tree->GetV4(),tree->GetV3() );//  (x,y, err x, err y)
  TCanvas* c1 = new TCanvas();
  gra->Draw("ap");
  gra->SetMarkerStyle(8);
  gra->SetLineWidth(2);
  TF1* flin = new TF1("flin","pol1",0,1500);
  gra->Fit("flin");
  gra->GetXaxis()->SetTitle("Energy [keV]");
  gra->GetYaxis()->SetTitle("NaI1 signal [Vxs]");

  double p1=flin->GetParameter(1);
  double p0=flin->GetParameter(0);
 

  /////     error ///////
  TCanvas* c2 = new TCanvas();
  
  tree->Draw(Form("sig*%e:ene:(esig)*%e:ene*0.001",1/p1,1/p1),"","goff");
  TGraphErrors* gra2 = new TGraphErrors(tree->GetSelectedRows(),tree->GetV2(),tree->GetV1(),tree->GetV4(),tree->GetV3());
  gra2->Draw("ap");
  gra2->SetMarkerStyle(8);
  gra2->SetLineWidth(2);
  TF1* fsig = new TF1("fsig","sqrt([1]*[1]*x+[0]*[0])",0,1500);
  fsig->SetParameter(0,10);
  fsig->SetParameter(1,5);
  
  gra2->Fit("fsig");
  gra2->GetXaxis()->SetTitle("Energy [keV]");
  gra2->GetYaxis()->SetTitle("#sigma [keV]");

  cout << "expected sigma@ 662 keV = " << fsig->Eval(662) << endl;
  cout << "expected sigma@ 59.5 keV = " << fsig->Eval(59.5) << endl;

  cout << "Alias ENaI1 " << Form("(-A2+%e)*%e",-p0,1./p1) << endl;
  return;
}
